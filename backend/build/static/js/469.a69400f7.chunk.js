"use strict";(self.webpackChunkparkplaza_frontend=self.webpackChunkparkplaza_frontend||[]).push([[469],{3223:(e,l,a)=>{a.d(l,{m:()=>s});var t=a(9950);const s=()=>{const[e,l]=(0,t.useState)(null),[a,s]=(0,t.useState)(!0),[n,i]=(0,t.useState)(null);(0,t.useEffect)(()=>{if(!navigator.geolocation)return i("Geolocation is not supported by this browser"),void s(!1);navigator.geolocation.getCurrentPosition(e=>{l({lat:e.coords.latitude,lng:e.coords.longitude}),s(!1)},e=>{console.error("Geolocation error:",e),i(e.message),s(!1),l({lat:28.6139,lng:77.209})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})},[]);return{location:e,loading:a,error:n,refreshLocation:()=>{s(!0),i(null),navigator.geolocation.getCurrentPosition(e=>{l({lat:e.coords.latitude,lng:e.coords.longitude}),s(!1)},e=>{i(e.message),s(!1)})}}}},3469:(e,l,a)=>{a.r(l),a.d(l,{default:()=>d});var t=a(9950),s=a(2569),n=a(5175),i=a(3223),o=a(4414);const d=()=>{var e,l,a,d,r,m,u,c,p;const{user:v}=(0,s.d4)(e=>e.auth),{location:x,error:g}=(0,i.m)(),[h,b]=(0,t.useState)({lat:"",lng:"",radiusMeters:2e3,limit:10,ownerEmail:""}),[f,y]=(0,t.useState)(!1),[j,N]=(0,t.useState)(!1),[w,S]=(0,t.useState)(null),[C,E]=(0,t.useState)("");(0,t.useEffect)(()=>{null!==x&&void 0!==x&&x.lat&&null!==x&&void 0!==x&&x.lng&&b(e=>({...e,lat:x.lat,lng:x.lng}))},[x]);const M="admin"===(null===v||void 0===v?void 0:v.role),k=e=>b(l=>({...l,[e.target.name]:e.target.value}));return(0,o.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Admin Dashboard"}),(0,o.jsxs)("div",{className:"bg-white shadow rounded p-6 mb-8",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Import Nearby Parking"}),(0,o.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"Use Google Places (paid/billed) or OpenStreetMap (free) to import nearby parking lots into your database."}),(0,o.jsxs)("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",onSubmit:async e=>{e.preventDefault(),y(!0),E(""),S(null);try{const e={lat:parseFloat(h.lat),lng:parseFloat(h.lng),radiusMeters:parseInt(h.radiusMeters||2e3,10),limit:parseInt(h.limit||10,10),ownerEmail:M&&h.ownerEmail?h.ownerEmail:void 0},l=await n.A.importPlaces(e);S((null===l||void 0===l?void 0:l.data)||l)}catch(e){var l,a,t,s;const n=(null===e||void 0===e||null===(l=e.response)||void 0===l||null===(a=l.data)||void 0===a?void 0:a.message)||(null===e||void 0===e?void 0:e.message)||"Import failed",i=null===e||void 0===e||null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.details;E(i?`${n} \u2014 ${i}`:n)}finally{y(!1)}},children:[(0,o.jsxs)("label",{className:"flex flex-col",children:[(0,o.jsx)("span",{className:"text-sm font-medium mb-1",children:"Latitude"}),(0,o.jsx)("input",{name:"lat",value:h.lat,onChange:k,type:"number",step:"any",required:!0,className:"border rounded px-3 py-2"})]}),(0,o.jsxs)("label",{className:"flex flex-col",children:[(0,o.jsx)("span",{className:"text-sm font-medium mb-1",children:"Longitude"}),(0,o.jsx)("input",{name:"lng",value:h.lng,onChange:k,type:"number",step:"any",required:!0,className:"border rounded px-3 py-2"})]}),(0,o.jsxs)("label",{className:"flex flex-col",children:[(0,o.jsx)("span",{className:"text-sm font-medium mb-1",children:"Radius (meters)"}),(0,o.jsx)("input",{name:"radiusMeters",value:h.radiusMeters,onChange:k,type:"number",min:"100",max:"50000",className:"border rounded px-3 py-2"})]}),(0,o.jsxs)("label",{className:"flex flex-col",children:[(0,o.jsx)("span",{className:"text-sm font-medium mb-1",children:"Limit"}),(0,o.jsx)("input",{name:"limit",value:h.limit,onChange:k,type:"number",min:"1",max:"20",className:"border rounded px-3 py-2"})]}),M&&(0,o.jsxs)("label",{className:"flex flex-col md:col-span-2",children:[(0,o.jsx)("span",{className:"text-sm font-medium mb-1",children:"Assign to Owner (email)"}),(0,o.jsx)("input",{name:"ownerEmail",value:h.ownerEmail,onChange:k,type:"email",placeholder:"owner1@gmail.com",className:"border rounded px-3 py-2"})]}),(0,o.jsxs)("div",{className:"md:col-span-2 flex items-center gap-3 flex-wrap",children:[(0,o.jsx)("button",{type:"submit",disabled:f,className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-60",children:f?"Importing\u2026":"Import (Google Places)"}),(0,o.jsx)("button",{type:"button",onClick:async()=>{N(!0),E(""),S(null);try{const e={lat:parseFloat(h.lat),lng:parseFloat(h.lng),radiusMeters:parseInt(h.radiusMeters||2e3,10),limit:parseInt(h.limit||10,10),ownerEmail:M&&h.ownerEmail?h.ownerEmail:void 0},l=await n.A.importOSM(e);S((null===l||void 0===l?void 0:l.data)||l)}catch(s){var e,l,a,t;const n=(null===s||void 0===s||null===(e=s.response)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.message)||(null===s||void 0===s?void 0:s.message)||"OSM import failed",i=null===s||void 0===s||null===(a=s.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.details;E(i?`${n} \u2014 ${i}`:n)}finally{N(!1)}},disabled:j,className:"bg-green-600 text-white px-4 py-2 rounded disabled:opacity-60",children:j?"Importing\u2026":"Import (OSM Free)"}),(0,o.jsx)("button",{type:"button",onClick:async()=>{y(!0),E(""),S(null);try{var e,l;const a={lat:parseFloat(h.lat),lng:parseFloat(h.lng),radiusMeters:parseInt(h.radiusMeters||2e3,10),count:parseInt(h.limit||10,10),ownerEmail:M&&h.ownerEmail?h.ownerEmail:void 0},t=await n.A.seedRandomLots(a);S({createdCount:(null===t||void 0===t||null===(e=t.data)||void 0===e||null===(l=e.lots)||void 0===l?void 0:l.length)||0})}catch(o){var a,t,s,i;const e=(null===o||void 0===o||null===(a=o.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)||(null===o||void 0===o?void 0:o.message)||"Seed failed",l=null===o||void 0===o||null===(s=o.response)||void 0===s||null===(i=s.data)||void 0===i?void 0:i.details;E(l?`${e} \u2014 ${l}`:e)}finally{y(!1)}},disabled:f,className:"bg-purple-600 text-white px-4 py-2 rounded disabled:opacity-60",children:f?"Seeding\u2026":"Seed Random (Dev)"}),g&&(0,o.jsxs)("span",{className:"text-xs text-red-500",children:["Geolocation error: ",String(g)]})]})]}),C&&(0,o.jsx)("div",{className:"mt-4 text-red-600 whitespace-pre-wrap",children:C}),w&&(0,o.jsxs)("div",{className:"mt-4 text-sm text-gray-700",children:[(0,o.jsx)("div",{className:"font-medium",children:"Import complete"}),(0,o.jsxs)("div",{children:["Created: ",null!==(e=null!==(l=w.createdCount)&&void 0!==l?l:null===(a=w.created)||void 0===a?void 0:a.length)&&void 0!==e?e:0]}),(0,o.jsxs)("div",{children:["Updated: ",null!==(d=null!==(r=w.updatedCount)&&void 0!==r?r:null===(m=w.updated)||void 0===m?void 0:m.length)&&void 0!==d?d:0]}),(0,o.jsxs)("div",{children:["Skipped: ",null!==(u=null!==(c=w.skippedCount)&&void 0!==c?c:null===(p=w.skipped)||void 0===p?void 0:p.length)&&void 0!==u?u:0]})]})]}),(0,o.jsx)("div",{className:"bg-white shadow rounded p-6",children:(0,o.jsx)("p",{className:"text-gray-600",children:"More admin tools will appear here."})})]})}}}]);